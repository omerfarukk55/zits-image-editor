<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Şekil & Yazı Ekle - {% if file_type == 'video' %}Video Editörü{% else %}Görsel Editörü{% endif %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { background: #f8f9fa; padding: 20px; }
        .editor-container { max-width: 900px; margin: 0 auto; background: #fff; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.08); padding: 30px; }
        .canvas-wrap { position: relative; display: inline-block; }
        #mainCanvas, #drawCanvas { position: absolute; top: 0; left: 0; }
        #mainCanvas { z-index: 1; }
        #drawCanvas { z-index: 2; pointer-events: auto; }
        .toolbar { margin-bottom: 15px; }
        .toolbar button, .toolbar input, .toolbar select { margin-right: 10px; }
        .video-controls { margin-top: 10px; }
        .result-container { margin-top: 30px; display: none; }
        .result-image, .result-video { max-width: 100%; border-radius: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    </style>
</head>
<body>
<div class="container editor-container">
    <h2 class="mb-4">{% if file_type == 'video' %}Videoya Yazı ve Şekil Ekle{% else %}Görsele Yazı ve Şekil Ekle{% endif %}</h2>
    <div class="mb-3">
        <label for="fileInput" class="form-label">{% if file_type == 'video' %}Video Seçin{% else %}Görsel Seçin{% endif %}:</label>
        <input type="file" id="fileInput" accept="{% if file_type == 'video' %}video/*{% else %}image/*{% endif %}" class="form-control">
    </div>
    <div class="toolbar mb-4">
        <button id="drawBtn" class="btn btn-outline-primary btn-sm active"><i class="fas fa-pen"></i> Çizim</button>
        <button id="textBtn" class="btn btn-outline-secondary btn-sm"><i class="fas fa-font"></i> Yazı</button>
        <select id="brushType" class="form-select form-select-sm" style="width:auto;display:inline-block;">
            <option value="normal">Normal</option>
            <option value="glow">Parlak</option>
            <option value="dotted">Noktalı</option>
        </select>
        <button id="rectBtn" class="btn btn-outline-info btn-sm"><i class="fas fa-square"></i> Dikdörtgen</button>
        <button id="circleBtn" class="btn btn-outline-info btn-sm"><i class="fas fa-circle"></i> Daire</button>
        <input type="color" id="colorPicker" value="#ff0000">
        <input type="range" id="brushSize" min="2" max="30" value="5">
        <span id="brushSizeValue">5px</span>
        <button id="clearBtn" class="btn btn-outline-danger btn-sm"><i class="fas fa-trash"></i> Temizle</button>
        <button id="resetBtn" class="btn btn-outline-dark btn-sm"><i class="fas fa-eraser"></i> Sıfırla</button>
        <button id="undoBtn" class="btn btn-outline-warning btn-sm"><i class="fas fa-undo"></i> Geri Al</button>
        <button id="downloadBtn" class="btn btn-success btn-sm"><i class="fas fa-download"></i> İndir</button>
    </div>
    <div class="canvas-wrap mb-3 d-flex justify-content-center align-items-center" id="canvasWrap" style="display:none; max-width:900px; max-height:600px; margin: 2rem auto; position:relative;">
        <canvas id="mainCanvas" style="display:block;"></canvas>
        <canvas id="drawCanvas" style="position:absolute; top:0; left:0; display:block;"></canvas>
        <video id="videoElement" controls style="display:none; max-width:100%; max-height:100%;"></video>
    </div>
    <div class="video-controls" style="display:none;">
        <button id="playPauseBtn" class="btn btn-secondary btn-sm"><i class="fas fa-play"></i> Oynat/Duraklat</button>
        <input type="range" id="videoSeek" min="0" max="100" value="0" style="width:200px;">
        <span id="currentTime">0:00</span> / <span id="duration">0:00</span>
    </div>
    <div class="mb-3" id="textInputWrap" style="display:none;">
        <input type="text" id="textInput" class="form-control" placeholder="Yazı girin ve canvas'a tıklayın">
    </div>
    <div>
        <button id="saveBtn" class="btn btn-success"><i class="fas fa-save"></i> Son Halini Kaydet</button>
        <button id="backBtn" class="btn btn-secondary">Geri Dön</button>
    </div>
    <div class="result-container" id="resultContainer">
        <h4>Sonuç</h4>
        <img id="resultImage" class="result-image" style="display:none;">
        <video id="resultVideo" class="result-video" controls style="display:none;"></video>
        <a id="videoDownloadBtn" class="btn btn-success mt-3" style="display:none;" download>Videoyu İndir</a>
        <a id="downloadBtn" class="btn btn-primary mt-3" download>Görseli İndir</a>
    </div>
</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<script src="/static/js/draw_editor.js"></script>
</body>
</html>